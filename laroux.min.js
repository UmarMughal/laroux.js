/*! laroux 28-12-2013 */
(function(){var laroux=function(a,b){if(a instanceof Array){var c;return c="undefined"==typeof b?document.querySelectorAll(a):b.querySelectorAll(a),Array.prototype.slice.call(c)}return"undefined"==typeof b?document.querySelector(a):b.querySelector(a)};laroux.baseLocation="",laroux.selectedMaster="",laroux.popupFunc=alert,laroux.readyPassed=!1,laroux.contentBegin=function(a,b){laroux.baseLocation=b,laroux.selectedMaster=a,laroux.events.invoke("contentBegin")},laroux.contentEnd=function(){laroux.events.invoke("contentEnd"),laroux.readyPassed=!0,window.setInterval(laroux.timers.ontick,500)},laroux.begin=function(a){laroux.events.add("contentBegin",a)},laroux.ready=function(a){return laroux.readyPassed?(a(),void 0):(laroux.events.add("contentEnd",a),void 0)},laroux.extend=function(a){for(var b in a)laroux.hasOwnProperty(b)||(laroux[b]=a[b])},laroux.events={delegates:[],add:function(a,b){laroux.events.delegates.push({event:a,fnc:b})},invoke:function(a,b){for(var c in laroux.events.delegates)laroux.events.delegates.hasOwnProperty(c)&&laroux.events.delegates[c].event==a&&laroux.events.delegates[c].fnc(b)}},laroux.timers={delegates:[],set:function(a,b,c){laroux.timers.delegates.push({timeout:a,fnc:b,obj:c})},ontick:function(){var a=[];for(var b in laroux.timers.delegates)if(laroux.timers.delegates.hasOwnProperty(b)){var c=laroux.timers.delegates[b];null===c.timeout?c.fnc(c.obj):(c.timeout-=.5,c.timeout<0&&(c.fnc(c.obj),a.unshift(b)))}for(var d in a)a.hasOwnProperty(d)&&laroux.timers.delegates.splice(a[d],1)}},laroux.triggers={delegates:[],list:[],set:function(a,b,c){for(var d in a)a.hasOwnProperty(d)&&-1==laroux.triggers.list.indexOf(a[d])&&laroux.triggers.list.push(a[d]);laroux.triggers.delegates.push({condition:a,fnc:b,obj:c})},ontrigger:function(a,b){var c=laroux.triggers.list.indexOf(a);-1!=c&&laroux.triggers.list.splice(c,1);var d=[];for(var e in laroux.triggers.delegates)if(laroux.triggers.delegates.hasOwnProperty(e)){var f=0,g=laroux.triggers.delegates[e];for(var h in g.condition)if(g.condition.hasOwnProperty(h)){var i=g.condition[h];-1!=laroux.triggers.list.indexOf(i)&&f++}0===f&&(g.fnc(g.obj,b),d.unshift(e))}for(var j in d)d.hasOwnProperty(j)&&laroux.triggers.delegates.splice(d[j],1);console.log("trigger name: "+a)}},laroux.dom={docprop:function(a){return document.documentElement.classList.contains(a)},select:function(a,b){var c;return c="undefined"==typeof b?document.querySelectorAll(a):b.querySelectorAll(a),Array.prototype.slice.call(c)},selectByClass:function(a,b){var c;return c="undefined"==typeof b?document.getElementsByClassName(a):b.getElementsByClassName(a),Array.prototype.slice.call(c)},selectSingle:function(a,b){return"undefined"==typeof b?document.querySelector(a):b.querySelector(a)},eventHistory:{},setEvent:function(a,b,c){for(var d=laroux.helpers.getAsArray(a),e=d.length-1;e>=0;e--)laroux.dom.setEventSingle(d[e],b,c)},setEventSingle:function(a,b,c){var d=function(b){c(b,a)===!1&&(b.preventDefault?b.preventDefault():window.event&&(window.event.returnValue=!1))};"undefined"==typeof laroux.dom.eventHistory[a]&&(laroux.dom.eventHistory[a]={}),"undefined"!=typeof laroux.dom.eventHistory[a][b]&&(a.removeEventListener?a.removeEventListener(b,laroux.dom.eventHistory[a][b],!1):a.detachEvent&&a.detachEvent("on"+b,laroux.dom.eventHistory[a][b])),laroux.dom.eventHistory[a][b]=d,a.addEventListener?a.addEventListener(b,d,!1):a.attachEvent&&a.attachEvent("on"+b,d)},unsetEvent:function(a,b){for(var c=laroux.helpers.getAsArray(a),d=c.length-1;d>=0;d--){if("undefined"==typeof laroux.dom.eventHistory[c[d]])return;"undefined"!=typeof laroux.dom.eventHistory[c[d]][b]&&(c[d].removeEventListener?c[d].removeEventListener(b,laroux.dom.eventHistory[c[d]][b],!1):c[d].detachEvent&&c[d].detachEvent("on"+b,laroux.dom.eventHistory[c[d]][b])),delete laroux.dom.eventHistory[c[d]][b]}},create:function(a){var b=document.createDocumentFragment(),c=document.createElement("DIV");for(laroux.dom.append(c,a);c.firstChild;)b.appendChild(c.firstChild);return b},createElement:function(a,b,c){var d=document.createElement(a);if("object"==typeof b)for(var e in b)b.hasOwnProperty(e)&&d.setAttribute(e,b[e]);if("object"==typeof c)for(var f in c)c.hasOwnProperty(f)&&d.setAttribute(f,c[f]);else"string"==typeof c&&laroux.dom.append(d,c);return d},createOption:function(a,b,c,d){var e=document.createElement("OPTION");e.setAttribute("value",b),"undefined"!=typeof d&&d===!0&&e.setAttribute("checked","checked"),laroux.dom.append(e,c),a.appendChild(e)},selectByValue:function(a,b){for(var c=a.options.length-1;c>=0;c--)if(a.options[c].getAttribute("value")==b){a.selectedIndex=c;break}},loadImage:function(){for(var a=[],b=arguments.length-1;b>=0;b--){var c=document.createElement("IMG");c.setAttribute("src",arguments[b]),a.push(c)}return a},loadAsyncScript:function(a,b,c){var d=document.createElement("script");d.type="text/javascript",d.async="undefined"!=typeof c?c:!0,d.src=a;var e=!1;d.onload=d.onreadystatechange=function(){return d.readyState&&"complete"!==d.readyState&&"loaded"!==d.readyState||e?!1:(d.onload=d.onreadystatechange=null,e=!0,"undefined"!=typeof b&&null!==b&&("function"==typeof b?b():laroux.triggers.ontrigger(b)),void 0)};var f=document.getElementsByTagName("head")[0];f.appendChild(d)},loadAsyncStyle:function(a,b,c){var d=document.createElement("LINK");d.type="text/css",d.async="undefined"!=typeof c?c:!0,d.href=a,d.rel="stylesheet";var e=!1;d.onload=d.onreadystatechange=function(){return d.readyState&&"complete"!==d.readyState&&"loaded"!==d.readyState||e?!1:(d.onload=d.onreadystatechange=null,e=!0,"undefined"!=typeof b&&null!==b&&("function"==typeof b?b():laroux.triggers.ontrigger(b)),void 0)};var f=document.getElementsByTagName("head")[0];f.appendChild(d)},clear:function(a){for(;a.hasChildNodes();)a.removeChild(a.firstChild)},insert:function(a,b,c){a.insertAdjacentHTML(b,c)},prepend:function(a,b){a.insertAdjacentHTML("afterbegin",b)},append:function(a,b){a.insertAdjacentHTML("beforeend",b)},replace:function(a,b){laroux.dom.clear(a),a.insertAdjacentHTML("afterbegin",b)},remove:function(a){null!==a.parentElement&&a.parentElement.removeChild(a)},cloneAppend:0,cloneInsertAfter:1,cloneInsertBefore:2,clone:function(a,b,c,d){var e=a.cloneNode(!0);return"undefined"==typeof c&&(c=a.parentNode),"undefined"==typeof d&&(d=a),"undefined"==typeof b||b==laroux.dom.cloneAppend?c.appendChild(e):b==laroux.dom.cloneInsertAfter?c.insertBefore(e,d.nextSibling):c.insertBefore(e,d),e},applyOperations:function(a,b){for(var c in b)if(b.hasOwnProperty(c))for(var d in b[c])if(b[c].hasOwnProperty(d)){var e=b[c][d];switch(c){case"setprop":if("_"==d.substring(0,1)){a.setAttribute(d.substring(1),e);continue}if("content"==d){laroux.dom.replace(a,e);continue}break;case"addprop":if("_"==d.substring(0,1)){a.setAttribute(d.substring(1),a.getAttribute(d.substring(1))+e);continue}if("content"==d){laroux.dom.append(a,e);continue}break;case"removeprop":if("_"==e.substring(0,1)){a.removeAttribute(e.substring(1));continue}if("content"==e){laroux.dom.clear(a);continue}break;case"addclass":laroux.css.addClass(a,e);break;case"removeclass":laroux.css.removeClass(a,e);break;case"addstyle":laroux.css.setProperty(a,d,e);break;case"removestyle":laroux.css.setProperty(a,e,"inherit !important");break;case"repeat":break;default:console.log(c)}}}},laroux.templates={engine:null,load:function(a,b){var c=a.innerHTML;return laroux.templates.engine.compile(c,b)},apply:function(a,b,c){var d=laroux.templates.load(a,c);return d.render(b)},insert:function(a,b,c,d,e){var f=laroux.templates.apply(a,b,e);"undefined"==typeof d&&(d="beforeend"),laroux.dom.insert(c,d,f)}},laroux.css={hasClass:function(a,b){return a.classList.contains(b)},addClass:function(a,b){a.classList.add(b)},removeClass:function(a,b){a.classList.remove(b)},toggleClass:function(a,b){a.classList.contains(b)?a.classList.remove(b):a.classList.add(b)},getProperty:function(a,b){var c=window.getComputedStyle(a);return c.getPropertyValue(b)},setProperty:function(a,b,c){for(var d=laroux.helpers.getAsArray(a),e=laroux.helpers.camelCase(b),f=d.length-1;f>=0;f--)d[f].style[e]=c},setTransitions:function(a,b){var c=laroux.helpers.getAsArray(a);for(var d in b)if(b.hasOwnProperty(d))for(var e=b[d],f=(laroux.helpers.camelCase(d),c.length-1);f>=0;f--){var g=window.getComputedStyle(c[f]),h=g.getPropertyValue("transition");if(null!==h){for(var i=h.split(","),j=0;j<i.length;j++)0===i[j].trim().localeCompare(d)&&delete i[j];c[f].style.transition=null!==e?i.join(", ")+", "+d+" "+e:i.join(", ")}else null!==e&&(c[f].style.transition=d+" "+e)}},transition:function(a,b,c){var d=laroux.helpers.getAsArray(a);for(var e in b)if(b.hasOwnProperty(e)){var f=b[e]instanceof Array?b[e]:[b[e]];"undefined"==typeof f[1]&&(f[1]="2s ease");for(var g=laroux.helpers.camelCase(e),h=d.length-1;h>=0;h--){var i=window.getComputedStyle(d[h]),j=i.getPropertyValue("transition");if(null!==j){for(var k=j.split(","),l=0;l<k.length;l++)0===k[l].trim().localeCompare(e)&&delete k[l];d[h].style.transition=null!==f[1]?k.join(", ")+", "+e+" "+f[1]:k.join(", ")}else null!==f[1]&&(d[h].style.transition=e+" "+f);d[h].style[g]=f[0],laroux.dom.unsetEvent(d[h],"transitionend"),"undefined"!=typeof c&&laroux.dom.setEvent(d[h],"transitionend",c)}}}},laroux.helpers={uniqueId:0,getUniqueId:function(){return"uid-"+ ++laroux.helpers.uniqueId},buildQueryString:function(a,b){var c="",d=/%20/g;"undefined"==typeof b&&(b=!1);for(var e in a)a.hasOwnProperty(e)&&"function"!=typeof a[e]&&(c+=b?"&"+encodeURIComponent(e).replace(d,"+")+"="+encodeURIComponent(a[e].toString()).replace(d,"+"):"&"+encodeURIComponent(e)+"="+encodeURIComponent(a[e].toString()));return c.substr(1)},buildFormData:function(a){var b=new FormData;for(var c in a)a.hasOwnProperty(c)&&"function"!=typeof a[c]&&b.append(c,a[c]);return b},camelCase:function(a){for(var b=!1,c="",d=0;d<a.length;d++)"-"!=a.charAt(d)?(c+=b?a.charAt(d).toUpperCase():a.charAt(d),b=!1):b=!0;return c},quoteAttr:function(a){return a.replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\r\n/g,"&#13;").replace(/[\r\n]/g,"&#13;")},random:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},find:function(a,b,c){var d;return a.some(function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},column:function(a,b){return a.map(function(a){return a[b]})},shuffle:function(a){var b=0,c=[];return a.forEach(function(a){var d=laroux.helpers.random(0,b);c[b++]=c[d],c[d]=a}),c},merge:function(a,b){var c=a;for(var d in b)c.hasOwnProperty(d)||(c[d]=b[d]);return c},getAsArray:function(a){var b;return b=a instanceof Array?a:a instanceof NodeList?Array.prototype.slice.call(a):[a]},getLength:function(a){return"object"==typeof a?"undefined"!=typeof a.length?a.length:Object.keys(a).length:-1}},laroux.cookies={get:function(a){return re=new RegExp(a+"=[^;]+","i"),document.cookie.match(re)?document.cookie.match(re)[0].split("=")[1]:null},set:function(a,b){document.cookie=a+"="+b+"; path="+laroux.baseLocation}},laroux.forms={ajaxForm:function(a,b,c){laroux.dom.setEvent(a,"submit",function(){return"undefined"!=typeof c&&c(),laroux.ajax.post(a.getAttribute("action"),laroux.forms.serializeFormData(a),b),!1})},isFormField:function(a){if("SELECT"==a.tagName)return!0;if("INPUT"==a.tagName){var b=a.getAttribute("type").toUpperCase();return"FILE"==b||"CHECKBOX"==b||"RADIO"==b||"TEXT"==b||"PASSWORD"==b||"HIDDEN"==b?!0:!1}return"TEXTAREA"==a.tagName?!0:!1},getFormFieldValue:function(a){if(a.disabled===!0)return null;if("SELECT"==a.tagName)return a.options[a.selectedIndex].value;if("INPUT"==a.tagName){var b=a.getAttribute("type").toUpperCase();return"FILE"==b?a.files[0]:"CHECKBOX"==b||"RADIO"==b?a.checked?a.value:null:"TEXT"==b||"PASSWORD"==b||"HIDDEN"==b?a.value:null}return"TEXTAREA"==a.tagName?a.value:null},setFormFieldValue:function(a,b){if(a.disabled!==!0)if("SELECT"!=a.tagName){if("INPUT"!=a.tagName)return"TEXTAREA"==a.tagName?(a.value=b,void 0):void 0;var c=a.getAttribute("type").toUpperCase();if("FILE"==c)return a.files[0]=b,void 0;if("CHECKBOX"==c||"RADIO"==c)return(b===!0||b==a.value)&&(a.checked=!0),void 0;if("TEXT"==c||"PASSWORD"==c||"HIDDEN"==c)return a.value=b,void 0}else for(var d in a.options)if(a.options.hasOwnProperty(d)&&a.options[d].value==b)return a.selectedIndex=d,void 0},toggleFormEditing:function(a,b){for(var c=a.querySelectorAll("*[name]"),d=0;d<c.length;d++)laroux.forms.isFormField(c[d])&&(b?c[d].removeAttribute("disabled"):c[d].setAttribute("disabled","disabled"))},serializeFormData:function(a){for(var b=new FormData,c=a.querySelectorAll("*[name]"),d=0;d<c.length;d++){var e=laroux.forms.getFormFieldValue(c[d]);null!==e&&b.append(c[d].getAttribute("name"),e)}return b},serialize:function(a){for(var b={},c=a.querySelectorAll("*[name]"),d=0;d<c.length;d++){var e=laroux.forms.getFormFieldValue(c[d]);null!==e&&(b[c[d].getAttribute("name")]=e)}return b},deserialize:function(a,b){for(var c=a.querySelectorAll("*[name]"),d=0;d<c.length;d++)laroux.forms.setFormFieldValue(c[d],b[c[d].getAttribute("name")])}},laroux.storage={data:[],install:function(){"undefined"!=typeof parent&&"undefined"!=typeof parent.frames.hidden&&("undefined"==typeof parent.frames.hidden.storage&&(parent.frames.hidden.storage=[]),laroux.storage.data=parent.frames.hidden.storage)},flush:function(){laroux.storage.data.length=0},exists:function(a){return"undefined"!=typeof laroux.storage.data[a]},set:function(a,b){laroux.storage.data[a]=b},get:function(a){return laroux.storage.data[a]}},laroux.ajax={wrappers:{registry:{"laroux.js":function(data){if(!data.isSuccess)return laroux.popupFunc("Error: "+data.errorMessage),void 0;var obj;return obj="json"==data.format?JSON.parse(data.object):"script"==data.format?eval(data.object):data.object}},set:function(a,b){laroux.ajax.wrappers.registry[a]=b}},_xhrf:null,_xhr:function(){return null===laroux.ajax._xhrf&&(laroux.ajax._xhrf=new XMLHttpRequest),laroux.ajax._xhrf},_xhrResp:function(xhr,options){var wrapperFunction=xhr.getResponseHeader("X-Response-Wrapper-Function"),response;return response="json"==options.datatype?JSON.parse(xhr.responseText):"script"==options.datatype?eval(xhr.responseText):"xml"==options.datatype?xhr.responseXML:xhr.responseText,null!==wrapperFunction&&"undefined"!=typeof laroux.ajax.wrappers.registry[wrapperFunction]&&(response=laroux.ajax.wrappers.registry[wrapperFunction](response)),{response:response,wrapperFunc:wrapperFunction}},makeRequest:function(a){var b=laroux.ajax._xhr(),c=null,d=0;"undefined"!=typeof a.timeout&&(c=setTimeout(function(){b.abort(),"undefined"!=typeof a.timeoutFn&&a.timeoutFn(a.url)},a.timeout)),b.onreadystatechange=function(){if(4==b.readyState){if(null!==c&&clearTimeout(c),b.status<300){var e=null,f=!0;try{e=laroux.ajax._xhrResp(b,a)}catch(g){"undefined"!=typeof a.error&&a.error(b,b.status,b.statusText),laroux.events.invoke("ajaxError",[b,b.status,b.statusText,a]),f=!1}f&&("undefined"!=typeof a.success&&null!==e&&a.success(e.response,e.wrapperFunc),laroux.events.invoke("ajaxSuccess",[b,e.response,e.wrapperFunc,a]))}else"undefined"!=typeof a.error&&a.error(b,b.status,b.statusText),laroux.events.invoke("ajaxError",[b,b.status,b.statusText,a]);"undefined"!=typeof a.complete&&a.complete(b,b.statusText),laroux.events.invoke("ajaxComplete",[b,b.statusText,a])}else"undefined"!=typeof a.progress&&a.progress(++d)};var e=a.url;if("object"==typeof a.getdata){var f=laroux.helpers.buildQueryString(a.getdata);f.length>0&&(e+=(e.indexOf("?")<0?"?":"&")+f)}b.open(a.type,e,!0);try{for(var g in a.headers)a.headers.hasOwnProperty(g)&&b.setRequestHeader(g,a.headers[g])}catch(h){console.log(h)}var i=null;"undefined"!=typeof a.postdata&&(i=a.postdata instanceof FormData?a.postdata:a.postdata instanceof Object?laroux.helpers.buildFormData(a.postdata):a.postdata),b.send(i)},get:function(a,b,c,d){laroux.ajax.makeRequest({type:"GET",url:a,getdata:b,datatype:"json",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","X-Requested-With":"XMLHttpRequest","X-Wrapper-Function":"laroux.js"},success:c,error:d})},getScript:function(a,b,c){laroux.ajax.makeRequest({type:"GET",url:a,datatype:"script",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","X-Requested-With":"XMLHttpRequest"},success:b,error:c})},post:function(a,b,c,d){laroux.ajax.makeRequest({type:"POST",url:a,postdata:b,datatype:"json",headers:{"X-Requested-With":"XMLHttpRequest","X-Wrapper-Function":"laroux.js"},success:c,error:d})},postJson:function(a,b,c,d){laroux.ajax.makeRequest({type:"POST",url:a,postdata:b instanceof Object?JSON.stringify(b):b,datatype:"json",headers:{"Content-Type":"application/json; charset=UTF-8","X-Requested-With":"XMLHttpRequest","X-Wrapper-Function":"laroux.js"},success:c,error:d})}},laroux.stack=function(){this.entries={},this.add=function(a,b){this.entries[a]=b},this.addRange=function(a){for(var b in a)a.hasOwnProperty(b)&&(this.entries[b]=a[b])},this.clear=function(){this.entries={}},this.length=function(){return Object.keys(this.entries).length}},this.$l=this.laroux=laroux}).call(this),function(a){a.ui={floatContainer:null,defaultPopupTimeout:5,createFloatContainer:function(){a.ui.floatContainer||(a.ui.floatContainer=a.dom.createElement("DIV",{id:"laroux_floatdiv"},""),document.body.insertBefore(a.ui.floatContainer,document.body.firstChild))},createBox:function(b,c,d){return a.dom.createElement("DIV",{id:b,"class":c},d)},msgbox:function(b,c){var d=a.helpers.getUniqueId(),e=a.ui.createBox(d,"laroux_msgbox",c);a.ui.floatContainer.appendChild(e),a.css.setProperty(e,"opacity","1"),a.timers.set(b,function(b){a.dom.remove(b)},e)}},a.date={parseEpoch:function(a){return 3e3>=a?"now":6e4>a?(a=Math.ceil(a/1e3),a+" seconds"):36e5>a?(a=Math.ceil(a/6e4),1==a?"a minute":a+" minutes"):864e5>a?(a=Math.ceil(a/36e5),1==a?"an hour":a+" hours"):6048e5>a?(a=Math.ceil(a/864e5),1==a?"a day":a+" days"):24192e5>a?(a=Math.ceil(a/6048e5),1==a?"a week":a+" weeks"):null},monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],getDateString:function(b){var c,d=new Date,e=("0"+b.getDate()).substr(-2,2),f=a.date.monthsShort[b.getMonth()],g=(""+b.getFullYear()).substr(2,2),h=d.getTime()-b.getTime();0>h?(c=!0,h=Math.abs(h)):c=!1;var i=a.date.parseEpoch(h);return null!==i?c?i+" later":i:e+" "+f+" "+g},getLongDateString:function(a){var b=("0"+a.getDate()).substr(-2,2),c=("0"+a.getMonth()).substr(-2,2),d=a.getFullYear(),e=("0"+a.getHours()).substr(-2,2),f=("0"+a.getMinutes()).substr(-2,2);return b+"."+c+"."+d+" "+e+":"+f},updateDatesElements:null,updateDates:function(){null===a.date.updateDatesElements&&(a.date.updateDatesElements=a.dom.select("*[data-epoch]")),a.date.updateDatesElements.forEach(function(b){var c=new Date(1e3*parseInt(b.getAttribute("data-epoch"),10));a.dom.replace(b,a.date.getDateString(c)),b.setAttribute("title",a.date.getLongDateString(c))})},trackDates:function(){a.date.updateDates(),a.timers.set(5,a.date.trackDates)}},a.ready(a.ui.createFloatContainer),a.popupFunc=function(b){a.ui.msgbox(a.ui.defaultPopupTimeout,b)}}(window.laroux);